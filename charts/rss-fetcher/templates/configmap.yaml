apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "rss-fetcher.fullname" . }}-config
  labels:
    {{- include "rss-fetcher.labels" . | nindent 4 }}
data:
  feeds.yaml: |
    feeds:
    {{- toYaml .Values.config.feeds | nindent 4 }}
    interval: {{ .Values.config.interval }}
    store:
      {{- if or .Values.valkey.enabled .Values.externalValkey.host }}
      type: valkey
      address: {{ include "rss-fetcher.valkey.serviceName" . }}:{{ if .Values.valkey.enabled }}{{ .Values.valkey.service.port }}{{ else }}{{ .Values.externalValkey.port }}{{ end }}
      {{- else }}
      type: memory
      {{- end }}
